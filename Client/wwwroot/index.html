<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Safir</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="Safir.Client.styles.css" rel="stylesheet" />
    <link href="manifest.json" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    <link href="FNT/stylesheet.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
    <link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet" />

    <script>
        (() => {
            try {
                const isDark = localStorage.getItem('isDarkMode') === 'true';
                document.documentElement.classList.toggle('dark-theme', isDark);
            } catch { }
        })();
    </script>

    <style>
        :root {
            --loader-primary: #1DB954; /* Spotify Green */
            --loader-grad-start: #f2fff8;
            --loader-grad-end: #ffffff;
            --loader-text: #333;
            --loader-particle: rgba(29, 185, 84, .2);
            --progress-bg: rgba(29, 185, 84, 0.15);
            --progress-glow: rgba(29, 185, 84, 0.6);
        }

        html.dark-theme {
            --loader-primary: #25D366; /* WhatsApp Green variant */
            --loader-grad-start: #080808; /* Darker */
            --loader-grad-end: #141414;
            --loader-text: #e2e2e2;
            --loader-particle: rgba(37, 211, 102, .15);
            --progress-bg: rgba(37, 211, 102, 0.12);
            --progress-glow: rgba(37, 211, 102, 0.5);
        }

        /* ---- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ Ø§Ø³Ù¾Ù„Ø´â€ŒØ§Ø³Ú©Ø±ÛŒÙ† ---- */
        .splash-screen {
            position: fixed; /* Ø«Ø§Ø¨Øª Ø±ÙˆÛŒ ØµÙØ­Ù‡ */
            inset: 0; /* Ù¾ÙˆØ´Ø´ Ú©Ø§Ù…Ù„ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(145deg, var(--loader-grad-start), var(--loader-grad-end));
            animation: bgShift 15s ease-in-out infinite alternate;
            overflow: hidden;
            z-index: 9999; /* Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ù‡Ù…Ù‡ Ø¹Ù†Ø§ØµØ± Ø¯ÛŒÚ¯Ø± */
            font-family: 'Vazirmatn', 'Roboto', sans-serif;
            /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù…Ø­Ùˆ Ø´Ø¯Ù† Ø¯Ø± Ø²Ù…Ø§Ù† Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† */
            opacity: 1;
            transform: scale(1);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        @keyframes bgShift {
            0% {
                filter: hue-rotate(0deg);
            }

            50% {
                filter: hue-rotate(10deg) brightness(1.03);
            }

            100% {
                filter: hue-rotate(-10deg);
            }
        }

        /* ---- Ø¨Ù„Ø§Ø¨ Ù…Ø±Ú©Ø²ÛŒ ---- */
        .blob {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 340px;
            height: 340px;
            background: var(--loader-primary);
            opacity: .12;
            filter: blur(60px);
            transform: translate(-50%, -50%);
            animation: blobMorph 30s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes blobMorph {
            0% {
                border-radius: 28% 72% 49% 51% / 42% 36% 64% 58%;
                transform: translate(-50%, -50%) scale(1) rotate(0deg);
            }

            25% {
                border-radius: 41% 59% 66% 34% / 57% 43% 57% 43%;
            }

            50% {
                border-radius: 62% 38% 29% 71% / 38% 47% 53% 62%;
                transform: translate(-60%, -40%) scale(1.15) rotate(180deg);
            }

            75% {
                border-radius: 28% 72% 49% 51% / 71% 62% 38% 29%;
            }

            100% {
                border-radius: 28% 72% 49% 51% / 42% 36% 64% 58%;
                transform: translate(-50%, -50%) scale(1) rotate(360deg);
            }
        }

        /* ---- Ø°Ø±Ø§Øª Ø´Ù†Ø§ÙˆØ± ---- */
        .particles {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--loader-particle);
            animation: particleFloat linear infinite;
        }

        @keyframes particleFloat {
            from {
                transform: translateY(0) scale(1) rotate(0deg);
                opacity: 1;
            }

            to {
                transform: translateY(-150px) scale(.5) rotate(360deg);
                opacity: 0;
            }
        }
        /* Ù…ÙˆÙ‚Ø¹ÛŒØª Ùˆ Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ 20 Ø°Ø±Ù‡ (Ú©Ø§Ù…Ù„ Ø¯Ø± Ú©Ø¯ Ø´Ù…Ø§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªØŒ Ø§ÛŒÙ†Ø¬Ø§ Ø®Ù„Ø§ØµÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´) */
        .particle:nth-child(1) {
            top: 10%;
            left: 15%;
            animation-duration: 6s;
            animation-delay: -1s;
        }

        .particle:nth-child(2) {
            top: 20%;
            left: 80%;
            animation-duration: 8s;
            animation-delay: -3s;
        }
        /* ... Ø¨Ù‚ÛŒÙ‡ 18 Ø°Ø±Ù‡ ... */
        .particle:nth-child(3) {
            top: 65%;
            left: 5%;
            animation-duration: 7s;
            animation-delay: -2s;
        }

        .particle:nth-child(4) {
            top: 85%;
            left: 60%;
            animation-duration: 9s;
            animation-delay: -4s;
        }

        .particle:nth-child(5) {
            top: 30%;
            left: 50%;
            animation-duration: 5s;
            animation-delay: -5s;
        }

        .particle:nth-child(6) {
            top: 55%;
            left: 75%;
            animation-duration: 7.5s;
            animation-delay: -6s;
        }

        .particle:nth-child(7) {
            top: 40%;
            left: 25%;
            animation-duration: 6.5s;
            animation-delay: -2s;
        }

        .particle:nth-child(8) {
            top: 75%;
            left: 35%;
            animation-duration: 11s;
            animation-delay: -1s;
        }

        .particle:nth-child(9) {
            top: 15%;
            left: 65%;
            animation-duration: 10s;
            animation-delay: -7s;
        }

        .particle:nth-child(10) {
            top: 50%;
            left: 90%;
            animation-duration: 9s;
            animation-delay: -3s;
        }

        .particle:nth-child(11) {
            top: 5%;
            left: 45%;
            animation-duration: 7s;
            animation-delay: -5s;
        }

        .particle:nth-child(12) {
            top: 92%;
            left: 15%;
            animation-duration: 8s;
            animation-delay: -4s;
        }

        .particle:nth-child(13) {
            top: 38%;
            left: 88%;
            animation-duration: 6s;
            animation-delay: -6s;
        }

        .particle:nth-child(14) {
            top: 12%;
            left: 22%;
            animation-duration: 5s;
            animation-delay: -7s;
        }

        .particle:nth-child(15) {
            top: 60%;
            left: 42%;
            animation-duration: 8s;
            animation-delay: -8s;
        }

        .particle:nth-child(16) {
            top: 70%;
            left: 70%;
            animation-duration: 9s;
            animation-delay: -9s;
        }

        .particle:nth-child(17) {
            top: 25%;
            left: 10%;
            animation-duration: 6s;
            animation-delay: -6s;
        }

        .particle:nth-child(18) {
            top: 82%;
            left: 48%;
            animation-duration: 10s;
            animation-delay: -3s;
        }

        .particle:nth-child(19) {
            top: 45%;
            left: 30%;
            animation-duration: 7s;
            animation-delay: -4s;
        }

        .particle:nth-child(20) {
            top: 18%;
            left: 55%;
            animation-duration: 6.5s;
            animation-delay: -2s;
        }


        /* ---- Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± Ø®Ø·ÛŒ ---- */
        .progress-container {
            position: relative;
            width: 280px;
            margin-top: 2rem;
            margin-bottom: 2.5rem;
        }

        .progress-track {
            height: 4px;
            border-radius: 8px;
            background: var(--progress-bg);
            overflow: hidden;
            position: relative;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--loader-primary) 70%, #80e2a7);
            border-radius: 8px;
            box-shadow: 0 0 10px var(--progress-glow);
            transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

            .progress-fill::after {
                content: "";
                position: absolute;
                top: 0;
                right: 0;
                height: 100%;
                width: 12px;
                background-color: rgba(255, 255, 255, 0.3);
                filter: blur(4px);
                animation: pulse 2s infinite;
            }

        @keyframes pulse {
            0%, 100% {
                opacity: 0.2;
            }

            50% {
                opacity: 0.6;
            }
        }

        .progress-value {
            font-size: 0.85rem;
            margin-top: 0.8rem;
            text-align: center;
            color: var(--loader-text);
            opacity: 0.8;
            font-weight: 500;
        }

        /* ---- Ù…ØªÙ† Ø§ØµÙ„ÛŒ Ùˆ Ø²ÛŒØ±Ù…ØªÙ† ---- */
        .loading-text, .loading-subtext {
            opacity: 0;
            transform: translateY(8px);
            transition: opacity .6s ease, transform .6s ease;
            color: var(--loader-text);
            direction: rtl;
        }

        .loading-text {
            font-size: 1.35rem;
            font-weight: 500;
            min-height: 2.2rem; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù¾Ø±Ø´ */
        }

        .loading-subtext {
            font-size: .9rem;
            margin-top: .8rem;
            min-height: 1.4rem; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù¾Ø±Ø´ */
        }

        .show {
            opacity: 1;
            transform: translateY(0);
        }
        /* Ú©Ù„Ø§Ø³ Ù…Ø´ØªØ±Ú© Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ§Ù† Ø´Ø¯Ù† */

        /* ---- Ø®Ø·Ø§ÛŒ Blazor ---- */
        #blazor-error-ui {
            background: #fff0f0;
            color: #ff3636;
            display: none;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 2000;
            padding: 1rem;
            box-shadow: 0 -2px 10px rgba(0,0,0,.1);
        }

            #blazor-error-ui .dismiss {
                cursor: pointer;
                position: absolute;
                right: 1rem;
                top: 1rem;
                font-size: 18px;
            }

            #blazor-error-ui a {
                color: #0066cc;
                text-decoration: none;
            }

                #blazor-error-ui a:hover {
                    text-decoration: underline;
                }
    </style>
</head>

<body>

    <div id="app">
        <div class="splash-screen" aria-label="Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡">
            <div class="blob"></div>
            <div class="particles">
                <span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span>
                <span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span>
                <span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span>
                <span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span><span class="particle"></span>
            </div>
            <div class="loading-text"></div>
            <div class="loading-subtext"></div>
            <div class="progress-container">
                <div class="progress-track">
                    <div class="progress-fill"></div>
                </div>
                <div class="progress-value">0%</div>
            </div>
        </div>
    </div>

    <script>
        // --- Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø³Ù¾Ù„Ø´â€ŒØ§Ø³Ú©Ø±ÛŒÙ† ---
        const mainMessages = [
            'Ø¯Ø± Ø­Ø§Ù„ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø³ÙÛŒØ± ...',
            'Ú†Ø§ÛŒ ÛŒØ§ Ù‚Ù‡ÙˆÙ‡ Ø±Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ...',
            'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒâ€ŒØ§Ù†Ø¯ ...',
            'Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… ...'
        ];
        const subMessages = [
            'ØªØ§ Ù„Ø­Ø¸Ø§ØªÛŒ Ø¯ÛŒÚ¯Ø± Ù‡Ù…Ø±Ø§Ù‡ Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ… â˜•',
            'Ø§Ù†Ø±Ú˜ÛŒ Ù…Ø«Ø¨Øª ÛŒØ§Ø¯Øª Ù†Ø±Ù‡ âœ¨',
            'Ù†ÙØ³ Ø¹Ù…ÛŒÙ‚ Ø¨Ú©Ø´ ğŸ˜Œ',
            'Ø§ÛŒÙ† Ø§Ù†ØªØ¸Ø§Ø± Ø§Ø±Ø²Ø´Ø´ Ø±Ø§ Ø¯Ø§Ø±Ø¯ ğŸ˜‰'
        ];

        const mainEl = document.querySelector('.loading-text');
        const subEl = document.querySelector('.loading-subtext');
        const progressFill = document.querySelector('.progress-fill');
        const progressValue = document.querySelector('.progress-value');
        const splashScreen = document.querySelector('.splash-screen');
        let mIndex = 0;
        let progressInterval = null; // Ù‡Ù†Ø¯Ù„ Ø¨Ø±Ø§ÛŒ setInterval Ù¾ÛŒØ´Ø±ÙØª
        let messageCycleTimeout = null; // Ù‡Ù†Ø¯Ù„ Ø¨Ø±Ø§ÛŒ setTimeout Ú†Ø±Ø®Ù‡ Ù¾ÛŒØ§Ù…

        const visibleTime = 3000; // Ø²Ù…Ø§Ù† Ù†Ù…Ø§ÛŒØ´ Ù‡Ø± Ù¾ÛŒØ§Ù… (Ù…ÛŒÙ„ÛŒâ€ŒØ«Ø§Ù†ÛŒÙ‡)
        const fadeTime = 600; // Ø²Ù…Ø§Ù† Ù…Ø­Ùˆ Ø´Ø¯Ù† (Ø¨Ø§ÛŒØ¯ Ø¨Ø§ transition CSS Ù‡Ù…Ø§Ù‡Ù†Ú¯ Ø¨Ø§Ø´Ø¯)

        // ØªØ§Ø¨Ø¹ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØª (ØªØ§ 99% Ù…ÛŒâ€ŒØ±ÙˆØ¯)
        function simulateProgress() {
            let progress = 0;
            const loadSteps = [
                { target: 15, speed: 30 },
                { target: 35, speed: 50 },
                { target: 65, speed: 70 },
                { target: 85, speed: 100 },
                { target: 95, speed: 150 }
            ];
            let currentStep = 0;

            if (progressInterval) clearInterval(progressInterval); // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† interval Ù‚Ø¨Ù„ÛŒ

            progressInterval = setInterval(() => {
                if (currentStep < loadSteps.length) {
                    progress += (loadSteps[currentStep].target - progress) / loadSteps[currentStep].speed;
                    if (progress >= loadSteps[currentStep].target - 0.5) {
                        currentStep++;
                    }
                    const displayProgress = Math.min(progress, 99); // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨Ù‡ 99%
                    progressFill.style.width = displayProgress + '%';
                    progressValue.textContent = Math.round(displayProgress) + '%';
                } else {
                    // Ø¯Ø± Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¯ÛŒÚ¯Ø± Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª interval Ø±Ø§ Ù…ØªÙˆÙ‚Ù Ú©Ù†ÛŒÙ…
                    // Ú†ÙˆÙ† completeLoading Ø¢Ù† Ø±Ø§ Ù…ØªÙˆÙ‚Ù Ø®ÙˆØ§Ù‡Ø¯ Ú©Ø±Ø¯.
                }
            }, 30);
        }

        // ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ùˆ Ø¨Ø³ØªÙ† Ø§Ø³Ù¾Ù„Ø´â€ŒØ§Ø³Ú©Ø±ÛŒÙ† (ØªÙˆØ³Ø· Blazor ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯)
        window.completeLoading = function () {
            console.log("CompleteLoading called by Blazor."); // Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯

            // ØªÙˆÙ‚Ù Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ Ùˆ ØªØ§ÛŒÙ…Ø±Ù‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
                console.log("Progress interval cleared.");
            }
            if (messageCycleTimeout) {
                clearTimeout(messageCycleTimeout);
                messageCycleTimeout = null;
                console.log("Message cycle timeout cleared.");
            }

            // ØªÙ†Ø¸ÛŒÙ… Ù†Ù‡Ø§ÛŒÛŒ Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø± Ø¨Ù‡ 100% Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
            progressFill.style.transition = 'width 0.5s ease-out'; // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù†Ø±Ù… Ø¨Ø±Ø§ÛŒ Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ 100%
            progressFill.style.width = '100%';
            progressValue.textContent = '100%';
            console.log("Progress set to 100%.");

            // Ø´Ø±ÙˆØ¹ ÙØ±Ø¢ÛŒÙ†Ø¯ Ù…Ø­Ùˆ Ú©Ø±Ø¯Ù† Ùˆ Ø­Ø°Ù Ø§Ø³Ù¾Ù„Ø´â€ŒØ§Ø³Ú©Ø±ÛŒÙ†
            setTimeout(() => {
                if (splashScreen) {
                    console.log("Fading out splash screen...");
                    splashScreen.style.opacity = '0';
                    splashScreen.style.transform = 'scale(0.95)'; // ÛŒØ§ scale(1.05) - Ø§ÙÚ©Øª Ú©ÙˆÚ†Ú© Ø´Ø¯Ù†/Ø¨Ø²Ø±Ú¯ Ø´Ø¯Ù†

                    // Ø­Ø°Ù Ú©Ø§Ù…Ù„ Ø§Ø² DOM Ù¾Ø³ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù…Ø­Ùˆ Ø´Ø¯Ù†
                    setTimeout(() => {
                        if (splashScreen) {
                            splashScreen.remove();
                            console.log("Splash screen removed from DOM.");
                        }
                    }, fadeTime); // Ø²Ù…Ø§Ù† Ø¨Ø§ÛŒØ¯ Ø¨Ø§ transition CSS Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø§Ø´Ø¯
                } else {
                    console.error("Splash screen element not found for removal.");
                }
            }, 400); // ØªØ§Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ù¾Ø³ Ø§Ø² Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ 100%
        };

        // ØªØ§Ø¨Ø¹ Ú†Ø±Ø®Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
        function cycleMessages() {
            if (messageCycleTimeout) clearTimeout(messageCycleTimeout); // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ§ÛŒÙ…â€ŒØ§ÙˆØª Ù‚Ø¨Ù„ÛŒ

            mainEl.classList.remove('show');
            subEl.classList.remove('show');

            setTimeout(() => {
                if (!splashScreen || splashScreen.style.opacity === '0') return; // Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ùˆ Ø´Ø¯Ù† Ø§Ø³ØªØŒ Ù…ØªÙˆÙ‚Ù Ø´Ùˆ

                mainEl.textContent = mainMessages[mIndex];
                subEl.textContent = subMessages[mIndex];
                mainEl.classList.add('show');
                subEl.classList.add('show');
                mIndex = (mIndex + 1) % mainMessages.length;

                // Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø¬Ø¯Ø¯ Ú†Ø±Ø®Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ - ÙÙ‚Ø· Ø§Ú¯Ø± Ù‡Ù†ÙˆØ² Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ Ù‡Ø³ØªÛŒÙ…
                messageCycleTimeout = setTimeout(cycleMessages, visibleTime + fadeTime);
            }, fadeTime);
        }

        // ØªØ¹Ø±ÛŒÙ Ø¢Ø¨Ø¬Ú©Øª loading Ø¨Ø±Ø§ÛŒ ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ø§Ø² Blazor
        window.loading = {
            complete: function () {
                if (typeof window.completeLoading === 'function') {
                    window.completeLoading();
                } else {
                    console.error("window.completeLoading function is not defined when called from Blazor.");
                }
            }
        };

        // Ø´Ø±ÙˆØ¹ Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§
        if (splashScreen) { // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² ÙˆØ¬ÙˆØ¯ Ø¹Ù†ØµØ± Ù‚Ø¨Ù„ Ø§Ø² Ø´Ø±ÙˆØ¹
            console.log("Starting initial splash screen animations.");
            simulateProgress();
            cycleMessages();
        } else {
            console.error("Splash screen element not found on initial load.");
        }

        // *** Ù…Ù‡Ù…: Ø¨Ø®Ø´ window.addEventListener('load', ...) Ú©Ù‡ Ù‚Ø¨Ù„Ø§ Ø¨ÙˆØ¯ØŒ Ø­Ø°Ù Ø´Ø¯Ù‡ Ø§Ø³Øª ***

    </script>


    <script>
        // Moved Cloudflare's service worker registration here
        // To ensure it runs AFTER your app's JS and Blazor runtime.
        // This is crucial for controlling caching behavior.
        if ('serviceWorker' in navigator) {
            // Check if we are in development mode (e.g., based on hostname)
            // In development, we force unregistration to avoid caching issues
            const isLocalhostOrDevelopment = window.location.hostname === "localhost" ||
                window.location.hostname === "127.0.0.1" ||
                window.location.hostname.includes("192.168."); // For local network IPs

            if (isLocalhostOrDevelopment) {
                console.warn("Service Worker: Running in development mode. Unregistering all service workers to prevent caching issues.");
                navigator.serviceWorker.getRegistrations().then(function (registrations) {
                    for (let registration of registrations) {
                        registration.unregister();
                    }
                }).catch(function (err) {
                    console.error('Service Worker unregistration failed: ', err);
                });
            } else {
                // In production, register the service worker
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('Service Worker: Registration successful with scope: ', reg.scope))
                    .catch(err => console.error('Service Worker: Registration failed: ', err));
            }
        }
    </script>

    <div id="blazor-error-ui">
        Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª.
        <a href="" class="reload">Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯</a>
        <a class="dismiss">ğŸ—™</a>
    </div>

    <script src="_content/MudBlazor/MudBlazor.min.js"></script>

    <script src="_framework/blazor.webassembly.js"></script>

    <script src="js/theme-storage.js"></script>
    <script src="js/geolocation.js"></script>
    <script src="js/downloadHelper.js"></script>
    <script src="js/cleanup.js"></script>

    <script>navigator.serviceWorker.register('service-worker.js');</script>

</body>
</html>